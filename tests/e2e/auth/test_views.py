import pytest
from fastapi.testclient import TestClient


@pytest.mark.e2e
def test_get_views(client: TestClient) -> None:
    response = client.get("/api/v1/views/")
    assert response.status_code == 200
    assert response.json() == {
        "user": [
            {
                "name": "UserForm",
                "view_type": "form",
                "model": "user",
                "fields": [
                    {
                        "name": "id",
                        "field_type": "number",
                        "widget": "number",
                        "required": False,
                        "readonly": True,
                        "disabled": True,
                        "is_primary_key": True,
                    },
                    {
                        "name": "username",
                        "title": "Username",
                        "field_type": "text",
                        "widget": "text",
                        "required": False,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                    {
                        "name": "email",
                        "title": "Email",
                        "field_type": "text",
                        "widget": "text",
                        "required": False,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                    {
                        "name": "is_active",
                        "title": "Is Active",
                        "field_type": "text",
                        "widget": "text",
                        "required": False,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                ],
            },
            {
                "name": "UserList",
                "view_type": "list",
                "model": "user",
                "fields": [
                    {
                        "name": "id",
                        "title": "ID",
                        "field_type": "number",
                        "widget": "number",
                        "required": False,
                        "readonly": True,
                        "disabled": True,
                        "is_primary_key": True,
                    },
                    {
                        "name": "username",
                        "title": "Username",
                        "field_type": "text",
                        "widget": "text",
                        "required": True,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                    {
                        "name": "email",
                        "title": "Email",
                        "field_type": "text",
                        "widget": "text",
                        "required": True,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                    {
                        "name": "password",
                        "title": "Password",
                        "field_type": "text",
                        "widget": "text",
                        "required": True,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                    {
                        "name": "is_active",
                        "title": "Is Active",
                        "field_type": "checkbox",
                        "widget": "checkbox",
                        "required": False,
                        "readonly": False,
                        "disabled": False,
                        "default_value": True,
                        "is_primary_key": False,
                    },
                    {
                        "name": "is_superuser",
                        "title": "Is Superuser",
                        "field_type": "checkbox",
                        "widget": "checkbox",
                        "required": False,
                        "readonly": False,
                        "disabled": False,
                        "default_value": False,
                        "is_primary_key": False,
                    },
                ],
            },
        ],
        "group": [
            {
                "name": "GroupList",
                "view_type": "list",
                "model": "group",
                "fields": [
                    {
                        "name": "id",
                        "title": "ID",
                        "field_type": "number",
                        "widget": "number",
                        "required": False,
                        "readonly": True,
                        "disabled": True,
                        "is_primary_key": True,
                    },
                    {
                        "name": "name",
                        "title": "Name",
                        "field_type": "text",
                        "widget": "text",
                        "required": True,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                ],
            },
            {
                "name": "GroupForm",
                "view_type": "form",
                "model": "group",
                "fields": [
                    {
                        "name": "id",
                        "title": "ID",
                        "field_type": "number",
                        "widget": "number",
                        "required": False,
                        "readonly": True,
                        "disabled": True,
                        "is_primary_key": True,
                    },
                    {
                        "name": "name",
                        "title": "Name",
                        "field_type": "text",
                        "widget": "text",
                        "required": True,
                        "readonly": False,
                        "disabled": False,
                        "is_primary_key": False,
                    },
                ],
            },
        ],
    }


@pytest.mark.e2e
def test_get_views_by_model(client: TestClient) -> None:
    response = client.get("/api/v1/views/user")
    assert response.status_code == 200
    assert response.json() == [
        {
            "name": "UserForm",
            "view_type": "form",
            "model": "user",
            "fields": [
                {
                    "name": "id",
                    "field_type": "number",
                    "widget": "number",
                    "required": False,
                    "readonly": True,
                    "disabled": True,
                    "is_primary_key": True,
                },
                {
                    "name": "username",
                    "title": "Username",
                    "field_type": "text",
                    "widget": "text",
                    "required": False,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
                {
                    "name": "email",
                    "title": "Email",
                    "field_type": "text",
                    "widget": "text",
                    "required": False,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
                {
                    "name": "is_active",
                    "title": "Is Active",
                    "field_type": "text",
                    "widget": "text",
                    "required": False,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
            ],
        },
        {
            "name": "UserList",
            "view_type": "list",
            "model": "user",
            "fields": [
                {
                    "name": "id",
                    "title": "ID",
                    "field_type": "number",
                    "widget": "number",
                    "required": False,
                    "readonly": True,
                    "disabled": True,
                    "is_primary_key": True,
                },
                {
                    "name": "username",
                    "title": "Username",
                    "field_type": "text",
                    "widget": "text",
                    "required": True,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
                {
                    "name": "email",
                    "title": "Email",
                    "field_type": "text",
                    "widget": "text",
                    "required": True,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
                {
                    "name": "password",
                    "title": "Password",
                    "field_type": "text",
                    "widget": "text",
                    "required": True,
                    "readonly": False,
                    "disabled": False,
                    "is_primary_key": False,
                },
                {
                    "name": "is_active",
                    "title": "Is Active",
                    "field_type": "checkbox",
                    "widget": "checkbox",
                    "required": False,
                    "readonly": False,
                    "disabled": False,
                    "default_value": True,
                    "is_primary_key": False,
                },
                {
                    "name": "is_superuser",
                    "title": "Is Superuser",
                    "field_type": "checkbox",
                    "widget": "checkbox",
                    "required": False,
                    "readonly": False,
                    "disabled": False,
                    "default_value": False,
                    "is_primary_key": False,
                },
            ],
        },
    ]
